<div
  (click)="onCardClick()"
  class="relative flex flex-col bg-white dark:bg-slate-800 rounded-2xl shadow-md dark:shadow-gray-900/20 border border-gray-300 dark:border-gray-700 overflow-hidden transition-all duration-200 hover:-translate-y-2 hover:shadow-xl dark:hover:shadow-gray-900/30 group h-full hover:border-gray-400 dark:hover:border-gray-600 cursor-pointer"
>
  <!-- Gradient Top Bar -->
  <div class="h-2 w-full bg-gradient-to-r from-accent to-warn"></div>

  <!-- Header: Title + Menu -->
  <div class="flex items-center justify-between px-4 py-4">
    <!-- Title with Icon -->
    <div class="flex items-center">
      <div class="flex items-center justify-center w-12 h-12 rounded-full bg-accent/20 dark:bg-accent/30 text-accent flex-shrink-0 shadow-sm">
        <span class="material-icons text-2xl">description</span>
      </div>
      <div class="flex-1 min-w-0 ml-4">
        <div 
          class="text-xl font-bold text-gray-900 dark:text-white truncate leading-tight overflow-hidden text-ellipsis" 
          >{{ prompt.name }}</div>
          <!-- [matTooltip]="prompt.promptName"
          matTooltipClass="custom-tooltip"
          [matTooltipPosition]="tooltipPosition" -->
      </div>
    </div>

    <!-- 3-dots menu (actions) -->
    <div class="relative flex-shrink-0">
      <button
        class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 flex items-center justify-center"
        tabindex="0"
        (click)="toggleMenu($event)"
        (mousedown)="$event.stopPropagation()"
        aria-label="More actions"
      >
        <span class="material-icons text-xl text-gray-500 dark:text-gray-400">more_vert</span>
      </button>
      <div
        *ngIf="showMenu"
        class="absolute right-0 mt-2 w-36 bg-white dark:bg-slate-900 rounded-lg shadow-lg dark:shadow-gray-900/50 border border-gray-300 dark:border-gray-600 py-1 z-20"
      >
        <button class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 flex items-center gap-2 transition-colors duration-200" (click)="$event.stopPropagation(); onEdit()">
          <span class="material-icons text-accent text-base">edit</span> Edit
        </button>
        <button class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 flex items-center gap-2 transition-colors duration-200" (click)="$event.stopPropagation(); showMenu = false;">
          <span class="material-icons text-accent text-base">content_copy</span> Clone
        </button>
        <button class="w-full text-left px-4 py-2 text-sm text-warn hover:bg-gray-100 dark:hover:bg-slate-800 flex items-center gap-2 transition-colors duration-200" (click)="$event.stopPropagation(); showMenu = false;">
          <span class="material-icons text-warn text-base">delete</span> Delete
        </button>
      </div>
    </div>
  </div>

  <!-- Divider -->
  <div class="border-t border-gray-300 dark:border-gray-600 mx-6"></div>

  <!-- Main Content -->
  <div class="flex flex-col flex-1 px-6 pt-4">
    <!-- Description -->
    <div class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed mb-6 flex-1 min-h-[4.5rem] max-h-[4.5rem] overflow-hidden [display:-webkit-box] [-webkit-line-clamp:4] [-webkit-box-orient:vertical]">
      {{ prompt.description }}
    </div>

    <!-- Pill Chips -->
    <div class="flex flex-wrap gap-2 mb-4">
      <span class="px-3 py-1.5 rounded-full bg-accent text-white text-xs font-semibold uppercase tracking-wide shadow-sm">{{ prompt.useCase }}</span>
      <span class="px-3 py-1.5 rounded-full border border-warn text-warn dark:text-warn bg-transparent text-xs font-semibold uppercase tracking-wide shadow-sm">{{ prompt.subUseCase }}</span>
    </div>

    <!-- Metadata Row -->
    <div class="flex flex-wrap items-center justify-between gap-4 mb-4 text-xs">
      <div class="flex items-center gap-1.5 text-gray-500 dark:text-gray-400">
        <span class="material-icons text-sm">person</span>
        <span class="truncate">{{ prompt.createdBy || 'Unknown' }}</span>
      </div>
      <div class="flex items-center gap-1.5" [ngClass]="prompt.published ? 'text-accent' : 'text-warn'">
        <span class="material-icons text-sm">
          {{ prompt.published ? 'check_circle' : 'hourglass_empty' }}
        </span>
        <span>{{ prompt.published ? 'Published' : 'Draft' }}</span>
      </div>
    </div>
  </div>

  <!-- Footer: Status + Last updated -->
  <div class="flex items-center justify-between px-6 py-4 border-t border-gray-200 dark:border-gray-600 text-xs bg-gray-50 dark:bg-slate-700/50">
    <!-- Left: Status -->
    <div class="flex items-center gap-2">
      <span class="material-icons text-accent text-sm">bolt</span>
      <span class="font-semibold text-accent">Live v{{ prompt.version }}</span>
    </div>
    <!-- Right: Last updated -->
    <div class="flex items-center gap-1.5 text-gray-500 dark:text-gray-400">
      <span class="material-icons text-sm">schedule</span>
      <span>{{ updatedAtDate }}</span>
    </div>
  </div>
</div> 